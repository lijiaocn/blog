<!DOCTYPE html>
<html lang="zh-Hans">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="博客模版：首先掌握ES6的模块用法，知道如何将一个大程序拆分相对独立的小文件，要承接大型的工程项目，module功能是必不可少的">
<meta name="keywords" content="博客模版,javascript,module,代码结构,项目结构">
<meta name="author" content="李佶澳">

<title>JavaScript/ES6 快速上手教程（三）：项目结构 博客模版</title>

<link rel="stylesheet" type="text/css" href="/blog/assets/bootstrap-3.3.7/css/bootstrap.min.css">
<!--link rel="stylesheet" type="text/css" href="/blog/assets/bootstrap-3.3.7/css/bootstrap-theme.min.css"-->
<link rel="stylesheet" type="text/css" href="/blog/assets/css/default.css">
<link rel="stylesheet" type="text/css" href="/blog/assets/css/highlight.css">
<link rel="alternate" type="application/rss+xml" title="博客模版" href="/feed.xml">
<link rel="icon" href="/favicon.ico">

<style type="text/css">
body{
	background-image: url(/blog/img/bg.png);
    background-position: left top;
    background-size: auto;
    background-repeat: repeat;
    background-attachment: scroll;
}
</style>



<script type="application/ld+json">
{
  "@context": "http://schema.org/",
  "@graph":[
    {
      "@type": "Organization",
      "logo": "https://www.lijiaocn.com/blog/img/logo-112x112.jpg",    //LOGO图片地址，必须是112x112，.jpg,.png,.gif
      "url": "https://www.lijiaocn.com"               //与Logo相关联的url
    },
/*   
    {   
      "@type": "WebSite",
      "url": "https://www.lijiaocn.com",              //被搜索的网站
      "potentialAction": {
        "@type": "SearchAction", 
                                                      //targe指定的域名必须是站点域名，不能用第三方搜索
        "target": "https://www.lijiaocn.com/search?q={search_term_string}+site%3Alijiaocn.com", 
        "query-input": "required name=search_term_string"
      }
    },
    {
      "@type": "Person",                         //社交账号
	  "name": "博客模版",                    //组织或个人名称
      "url": "https://www.lijiaocn.com",         //网站地址
      "sameAs": [
        "http://www.facebook.com/your-profile",  //社交账号地址，不支持的国内的
        "http://instagram.com/yourProfile",
        "http://www.linkedin.com/in/yourprofile",
        "http://plus.google.com/your_profile"
      ]
    },
*/
    {
      "@type": "BreadcrumbList",
       "itemListElement": [{
          "@type": "ListItem",
          "position": 1,
          
          
          "name": "系列教程",
          "item": "https://www.lijiaocn.com/blog/c/tutorial/"
       },{
          "@type": "ListItem",
          "position": 2,
          "name": "项目",
          "item": "https://www.lijiaocn.com/blog/t/all#项目"
       }]
    },
    {
      "@type": "Article",
      "dateModified": "2015-02-05T08:00:00+08:00",
      "datePublished": "2015-02-05T08:00:00+08:00",
      "headline": "JavaScript/ES6 快速上手教程（三）：项目结构",
      "image": [                                                //提供三张不同比例的高清图片，长x宽 >= 300 000 
        "https://www.lijiaocn.com/blog/img/cover/1x1/javascript.003.jpg",  //至少：600*600 = 360 000
        "https://www.lijiaocn.com/blog/img/cover/4x3/javascript.003.jpg",  //至少：800*600 = 480 000
        "https://www.lijiaocn.com/blog/img/cover/16x9/javascript.003.jpg"  //至少：960*540 = 518 400
      ],
      "author": {
        "@type": "Person",
        "name": "李佶澳"    //作者名称
      },
      "publisher": {
         "@type": "Organization",
         "name": "博客模版",                          //发布机构名称
         "logo": {
           "@type": "ImageObject",
           "url": "https://www.lijiaocn.com/blog/img/logo-112x112.jpg" //发布机构Logo,遵循
         }
      },
      "description": "首先掌握ES6的模块用法，知道如何将一个大程序拆分相对独立的小文件，要承接大型的工程项目，module功能是必不可少的",
      "mainEntityOfPage": "https://www.lijiaocn.com/blog/tutorial/2019/06/20/javascript-03-project/",       //网页权威链接，无重复网页就设置成当前页地址
      "speakable": {
        "@type": "SpeakableSpecification",
        "xpath": [
          "/html/head/title",                              //指向head中的title
          "/html/head/meta[@name='description']/@content"  //指向head中的description
         ]
      }
    }
  ]
 }
</script>



<!--Google ads 全局依赖代码 -->
<script async="async" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Global site tag (gtag.js) - Google Analytics 全局依赖代码-->
<script async="async" src="https://www.googletagmanager.com/gtag/js?id=UA-105389858-1"></script>
<!-- 需要尽早执行的js代码 -->
<script async="async" src="/blog/assets/js/head.js" ></script>

</head>
<body>
    <nav class="topnav">
        <!-- display sm md lg -->
<div class="container" >
  <div class="navbar-header">
    <button id="navb" type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#categories" aria-expanded="false" aria-controls="navbar">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar" style="color:black"></span>
      <span class="icon-bar"></span>
      <span class="icon-bar"></span>
    </button>
    <div class="navbar-brand hidden-sm">
      <span><a href="https://www.lijiaocn.com/blog/" title="主页">博客模版</a></span>
      <span class="glyphicon glyphicon-hand-right" style="margin-left:15px"></span>
    </div>
  </div>
  <div class="collapse navbar-collapse" id="categories">
    <ul class="nav navbar-nav">
       
      <li><a href="/blog/c/tutorial/">系列教程</a></li>
       
      <li><a href="/blog/c/book/">读书笔记</a></li>
       
      <li><a href="/blog/c/know/">认知感悟</a></li>
       
      <li><a href="/blog/c/money/">金钱管理</a></li>
       
      <li><a href="/blog/c/policy/">政策政务</a></li>
       
      <li><a href="/blog/c/skill/">软件技巧</a></li>
       
      <li><a href="/blog/c/share/">共享资源</a></li>
      
      <li><a href="/blog/t/all/">标签</a></li>
    </ul>
  </div>
</div>

    </nav>

    <section class="banner">
        
    </section>

    <section class="main">
        <div class="main-header">
            <div class="title">
                <h1>JavaScript/ES6 快速上手教程（三）：项目结构</h1>
            </div>

            <div class="pageheader">
                <p>
<span>
<a target="_blank" style="color:red;font-weight:bold" href="https://www.lijiaocn.com/shop">每日红包&精选购物</a>
</span>
</p>


            </div>

            <div class="top_ad">
                <!-- 顶部条幅广告 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8176866190626448"
     data-ad-slot="1000173679"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>

                <br>
            </div>

            <div class="top_social">
                
            </div>
        </div>

        <div class="main-body">
            <article class="content">
                
<div style="text-align:center">
  <img src="/blog/img/cover/16x9/javascript.003.jpg" alt="JavaScript/ES6 快速上手教程（三）：项目结构"/>
</div>


<div>
  <h2 id="本篇目录">本篇目录</h2>

<ul id="markdown-toc">
  <li><a href="#本篇目录" id="markdown-toc-本篇目录">本篇目录</a></li>
  <li><a href="#说明" id="markdown-toc-说明">说明</a></li>
  <li><a href="#模块" id="markdown-toc-模块">模块</a></li>
  <li><a href="#export-指令" id="markdown-toc-export-指令">export 指令</a>    <ul>
      <li><a href="#两种写法" id="markdown-toc-两种写法">两种写法</a></li>
      <li><a href="#函数和类的导出" id="markdown-toc-函数和类的导出">函数和类的导出</a></li>
      <li><a href="#重命名导出" id="markdown-toc-重命名导出">重命名导出</a></li>
      <li><a href="#导出值是动态绑定的" id="markdown-toc-导出值是动态绑定的">导出值是动态绑定的</a></li>
    </ul>
  </li>
  <li><a href="#import-指令" id="markdown-toc-import-指令">import 指令</a>    <ul>
      <li><a href="#导入的变量都是只读的" id="markdown-toc-导入的变量都是只读的">导入的变量都是只读的</a></li>
      <li><a href="#只加载执行" id="markdown-toc-只加载执行">只加载执行</a></li>
    </ul>
  </li>
  <li><a href="#exportimport-混合使用" id="markdown-toc-exportimport-混合使用">export、import 混合使用</a>    <ul>
      <li><a href="#模块整体导入" id="markdown-toc-模块整体导入">模块整体导入</a></li>
      <li><a href="#模块的默认导出" id="markdown-toc-模块的默认导出">模块的默认导出</a></li>
      <li><a href="#将另一个模块中的变量导出" id="markdown-toc-将另一个模块中的变量导出">将另一个模块中的变量导出</a></li>
    </ul>
  </li>
  <li><a href="#在-node-中使用-import" id="markdown-toc-在-node-中使用-import">在 Node 中使用 import</a>    <ul>
      <li><a href="#方法1-用-bazel-引导" id="markdown-toc-方法1-用-bazel-引导">方法1: 用 bazel 引导</a></li>
      <li><a href="#方法2-experimental-modules" id="markdown-toc-方法2-experimental-modules">方法2: –experimental-modules</a></li>
    </ul>
  </li>
  <li><a href="#参考" id="markdown-toc-参考">参考</a></li>
</ul>

<h2 id="说明">说明</h2>

<p><a href="https://es6.ruanyifeng.com/#docs/module" title="ECMAScript 6 入门：Module 的语法">ECMAScript 6 入门：Module 的语法</a>中介绍，JavaScript 一直是没有 module 功能的，大型项目无法分拆成多个模块实现。在 ES6 之前，CommonJS 和 AMD 分别实现了服务端的模块加载方案和浏览器端的模块加载方案。ES6 在语言标准上支持的模块功能，是浏览器和服务端通用的模块解决方案。</p>

<h2 id="模块">模块</h2>

<p>ECMAScript 6 中，一个模块就是一个 js 文件。</p>

<p>需要特别注意的是：ES6 的模块全部都是严格模式，无论是否在文件头添加了“use strict”。</p>

<p>严格模式是 ES5 引进的，主要有以下限制：</p>

<ol>
  <li>变量必须声明后再使用</li>
  <li>函数的参数不能有同名属性，否则报错</li>
  <li>不能使用with语句</li>
  <li>不能对只读属性赋值，否则报错</li>
  <li>不能使用前缀 0 表示八进制数，否则报错</li>
  <li>不能删除不可删除的属性，否则报错</li>
  <li>不能删除变量delete prop，会报错，只能删除属性delete global[prop]</li>
  <li>eval不会在它的外层作用域引入变量</li>
  <li>eval和arguments不能被重新赋值</li>
  <li>arguments不会自动反映函数参数的变化</li>
  <li>不能使用arguments.callee</li>
  <li>不能使用arguments.caller</li>
  <li>禁止this指向全局对象</li>
  <li>不能使用fn.caller和fn.arguments获取函数调用的堆栈</li>
  <li>增加了保留字（比如protected、static和interface）</li>
</ol>

<p>export、import 用于模块的导出导入，这两个指令最先执行，是静态加载，必须在模块的顶层。</p>

<p>Node 中的 require 方法是动态加载，和 export、import 不同：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">./</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">fileName</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">myModual</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="nx">path</span><span class="p">);</span>
</code></pre></div></div>

<p>ECMAScript 6 有一个提案，用 <a href="https://es6.ruanyifeng.com/#docs/module#import">import()</a> 实现动态加载。</p>

<h2 id="export-指令">export 指令</h2>

<p>export 在模块内指定可以导出的变量，只有用 export 指定的变量可以在模块外使用。</p>

<p>export 可以在<code class="language-plaintext highlighter-rouge">模块顶层</code>的任何位置使用，不能在块级作用域（函数内部、条件代码块中等）中。</p>

<h3 id="两种写法">两种写法</h3>

<p>export 写法1：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">var</span> <span class="nx">firstName</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Michael</span><span class="dl">'</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">var</span> <span class="nx">lastName</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Jackson</span><span class="dl">'</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">var</span> <span class="nx">year</span> <span class="o">=</span> <span class="mi">1958</span><span class="p">;</span>
</code></pre></div></div>

<p>export 写法2：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">firstName</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Michael</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">lastName</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">Jackson</span><span class="dl">'</span><span class="p">;</span>
<span class="kd">var</span> <span class="nx">year</span> <span class="o">=</span> <span class="mi">1958</span><span class="p">;</span>

<span class="k">export</span> <span class="p">{</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">year</span> <span class="p">};</span>
</code></pre></div></div>

<h3 id="函数和类的导出">函数和类的导出</h3>

<p>函数的导出：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">function</span> <span class="nx">multiply</span><span class="p">(</span><span class="nx">x</span><span class="p">,</span> <span class="nx">y</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nx">x</span> <span class="o">*</span> <span class="nx">y</span><span class="p">;</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="重命名导出">重命名导出</h3>

<p>可以用 <code class="language-plaintext highlighter-rouge">as</code> 将变量重命名，导出为其它的名字：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">function</span> <span class="nx">v1</span><span class="p">()</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>
<span class="kd">function</span> <span class="nx">v2</span><span class="p">()</span> <span class="p">{</span> <span class="p">...</span> <span class="p">}</span>

<span class="k">export</span> <span class="p">{</span>
  <span class="nx">v1</span> <span class="k">as</span> <span class="nx">streamV1</span><span class="p">,</span>
  <span class="nx">v2</span> <span class="k">as</span> <span class="nx">streamV2</span><span class="p">,</span>
  <span class="nx">v2</span> <span class="k">as</span> <span class="nx">streamLatestVersion</span>
<span class="p">};</span>
</code></pre></div></div>

<h3 id="导出值是动态绑定的">导出值是动态绑定的</h3>

<p>这一点需要特别注意：export 导出的变量，从模块外获取的是它在模块的内的实时值。</p>

<p>例如下面的模块，导出的变量 foo 的初始值是 <code class="language-plaintext highlighter-rouge">bar</code>，在模块内用 setTimeout 设置超时处理，500 毫秒后，编程 <code class="language-plaintext highlighter-rouge">baz</code>：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="kd">var</span> <span class="nx">foo</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">bar</span><span class="dl">'</span><span class="p">;</span>
<span class="nx">setTimeout</span><span class="p">(()</span> <span class="o">=&gt;</span> <span class="nx">foo</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">baz</span><span class="dl">'</span><span class="p">,</span> <span class="mi">500</span><span class="p">);</span>
</code></pre></div></div>

<p>在模块外使用的 foo，拥有同样的特性，即在 500 毫秒后，值变为 <code class="language-plaintext highlighter-rouge">baz</code>。</p>

<h2 id="import-指令">import 指令</h2>

<p>import 用于在当前模块中导入另外一个模块，导入的变量可以在当前模块中直接使用。</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">firstName</span><span class="p">,</span> <span class="nx">lastName</span><span class="p">,</span> <span class="nx">year</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./profile.js</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div></div>

<p>可以用 as 重命名导入的变量：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">lastName</span> <span class="k">as</span> <span class="nx">surname</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./profile.js</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div></div>

<p>from 后面的模块文件，可使用相对路径和绝对路径，后缀 <code class="language-plaintext highlighter-rouge">.js</code> 可以省略。</p>

<p>也可以不带路径，直接使用模块名，但是这样需要提前在配置文件告知 JavaScript 的模块的位置：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">myMethod</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">util</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div></div>

<h3 id="导入的变量都是只读的">导入的变量都是只读的</h3>

<p>不能修改导入的变量的值，即使导入变量的属性能够修改，也不应修改。</p>

<p>直接修改导入的变量是语法错误：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">a</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./xxx.js</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">a</span> <span class="o">=</span> <span class="p">{};</span> <span class="c1">// Syntax Error : 'a' is read-only;</span>
</code></pre></div></div>

<p>导入变量的属性是可以修改的，但是非常危险！因为其它导入了这个模块的模块，也会看到修改后的属性！这样会使被导入的模块的实现不可控、不可靠！</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span><span class="nx">a</span><span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./xxx.js</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">a</span><span class="p">.</span><span class="nx">foo</span> <span class="o">=</span> <span class="dl">'</span><span class="s1">hello</span><span class="dl">'</span><span class="p">;</span> <span class="c1">// 合法操作，但不应该这样做！</span>
</code></pre></div></div>

<h3 id="只加载执行">只加载执行</h3>

<p>可以只加载执行导入的模块：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="dl">'</span><span class="s1">lodash</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div></div>

<p>一个模块如果被重复导入多次，只会加载执行一次。</p>

<h2 id="exportimport-混合使用">export、import 混合使用</h2>

<p>在一些场景下，export 和 import 可以混合使用。</p>

<h3 id="模块整体导入">模块整体导入</h3>

<p>可以将一个模块整体加载，然后用 <code class="language-plaintext highlighter-rouge">.</code> 操作符引用模块的导出变量。</p>

<p>例如下面这个模块：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// circle.js</span>

<span class="k">export</span> <span class="kd">function</span> <span class="nx">area</span><span class="p">(</span><span class="nx">radius</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="nx">radius</span> <span class="o">*</span> <span class="nx">radius</span><span class="p">;</span>
<span class="p">}</span>

<span class="k">export</span> <span class="kd">function</span> <span class="nx">circumference</span><span class="p">(</span><span class="nx">radius</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">PI</span> <span class="o">*</span> <span class="nx">radius</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<p>整体导入的使用方式：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="o">*</span> <span class="k">as</span> <span class="nx">circle</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./circle</span><span class="dl">'</span><span class="p">;</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">圆面积：</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">circle</span><span class="p">.</span><span class="nx">area</span><span class="p">(</span><span class="mi">4</span><span class="p">));</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">圆周长：</span><span class="dl">'</span> <span class="o">+</span> <span class="nx">circle</span><span class="p">.</span><span class="nx">circumference</span><span class="p">(</span><span class="mi">14</span><span class="p">));</span>
</code></pre></div></div>

<p>导入的变量同样是只读的，不能改变。</p>

<h3 id="模块的默认导出">模块的默认导出</h3>

<p><code class="language-plaintext highlighter-rouge">export default</code> 指定模块的默认导出，一个模块只能有一个默认导出，因此 export default 在模块内只能用一次。</p>

<p>export default 的真实含义是定义了名为 default 的变量，并将其导出。</p>

<p>设置了默认导出的模块：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// export-default.js</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
  <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">);</span>
<span class="p">}</span>

</code></pre></div></div>

<p>导入方法，customName 默认导出的 default 变量的新名字，不需要包含在 <code class="language-plaintext highlighter-rouge">{}</code> 中：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// import-default.js</span>
<span class="k">import</span> <span class="nx">customName</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./export-default</span><span class="dl">'</span><span class="p">;</span>
<span class="nx">customName</span><span class="p">();</span> <span class="c1">// 'foo'</span>
</code></pre></div></div>

<h3 id="将另一个模块中的变量导出">将另一个模块中的变量导出</h3>

<p>可以在当前模块中导入另一个模块中的变量，然后作为本模块的导出：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="p">{</span> <span class="nx">foo</span><span class="p">,</span> <span class="nx">bar</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">my_module</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div></div>

<p>等同于：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">foo</span><span class="p">,</span> <span class="nx">bar</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">my_module</span><span class="dl">'</span><span class="p">;</span>
<span class="k">export</span> <span class="p">{</span> <span class="nx">foo</span><span class="p">,</span> <span class="nx">bar</span> <span class="p">};</span>
</code></pre></div></div>

<p>默认导出的再次导出：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">export</span> <span class="p">{</span> <span class="k">default</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">foo</span><span class="dl">'</span><span class="p">;</span>
</code></pre></div></div>

<p>还可以将一个模块整体导入后，再整体导出，形成类似继承的关系，被继承的模块的默认导出被 <code class="language-plaintext highlighter-rouge">export *</code> 忽略：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// circleplus.js</span>

<span class="k">export</span> <span class="o">*</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">circle</span><span class="dl">'</span><span class="p">;</span>
<span class="k">export</span> <span class="kd">var</span> <span class="nx">e</span> <span class="o">=</span> <span class="mf">2.71828182846</span><span class="p">;</span>
<span class="k">export</span> <span class="k">default</span> <span class="kd">function</span><span class="p">(</span><span class="nx">x</span><span class="p">)</span> <span class="p">{</span>
  <span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">exp</span><span class="p">(</span><span class="nx">x</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="在-node-中使用-import">在 Node 中使用 import</h2>

<p>Node 12 对 import 还不是默认支持的，直接用 node 运行使用了 import 的 js 文件会报下面的错误：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">module1</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./module1.js</span><span class="dl">'</span>
       <span class="o">^^^^^^^</span>

<span class="nx">SyntaxError</span><span class="p">:</span> <span class="nx">Unexpected</span> <span class="nx">identifier</span>
    <span class="nx">at</span> <span class="nx">Module</span><span class="p">.</span><span class="nx">_compile</span> <span class="p">(</span><span class="nx">internal</span><span class="o">/</span><span class="nx">modules</span><span class="o">/</span><span class="nx">cjs</span><span class="o">/</span><span class="nx">loader</span><span class="p">.</span><span class="nx">js</span><span class="p">:</span><span class="mi">718</span><span class="p">:</span><span class="mi">23</span><span class="p">)</span>
    <span class="nx">at</span> <span class="nb">Object</span><span class="p">.</span><span class="nx">Module</span><span class="p">.</span><span class="nx">_extensions</span><span class="p">..</span><span class="nx">js</span> <span class="p">(</span><span class="nx">internal</span><span class="o">/</span><span class="nx">modules</span><span class="o">/</span><span class="nx">cjs</span><span class="o">/</span><span class="nx">loader</span><span class="p">.</span><span class="nx">js</span><span class="p">:</span><span class="mi">785</span><span class="p">:</span><span class="mi">10</span><span class="p">)</span>
    <span class="nx">at</span> <span class="nx">Module</span><span class="p">.</span><span class="nx">load</span> <span class="p">(</span><span class="nx">internal</span><span class="o">/</span><span class="nx">modules</span><span class="o">/</span><span class="nx">cjs</span><span class="o">/</span><span class="nx">loader</span><span class="p">.</span><span class="nx">js</span><span class="p">:</span><span class="mi">641</span><span class="p">:</span><span class="mi">32</span><span class="p">)</span>
    <span class="nx">at</span> <span class="nb">Function</span><span class="p">.</span><span class="nx">Module</span><span class="p">.</span><span class="nx">_load</span> <span class="p">(</span><span class="nx">internal</span><span class="o">/</span><span class="nx">modules</span><span class="o">/</span><span class="nx">cjs</span><span class="o">/</span><span class="nx">loader</span><span class="p">.</span><span class="nx">js</span><span class="p">:</span><span class="mi">556</span><span class="p">:</span><span class="mi">12</span><span class="p">)</span>
    <span class="nx">at</span> <span class="nb">Function</span><span class="p">.</span><span class="nx">Module</span><span class="p">.</span><span class="nx">runMain</span> <span class="p">(</span><span class="nx">internal</span><span class="o">/</span><span class="nx">modules</span><span class="o">/</span><span class="nx">cjs</span><span class="o">/</span><span class="nx">loader</span><span class="p">.</span><span class="nx">js</span><span class="p">:</span><span class="mi">837</span><span class="p">:</span><span class="mi">10</span><span class="p">)</span>
    <span class="nx">at</span> <span class="nx">internal</span><span class="o">/</span><span class="nx">main</span><span class="o">/</span><span class="nx">run_main_module</span><span class="p">.</span><span class="nx">js</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">11</span>
</code></pre></div></div>

<p>要解决这个问题，可以用 bazel 引导启用，或者使用 node 9 引入的在 node 12 时依然是实验状态的特性：<code class="language-plaintext highlighter-rouge">--experimental-modules</code>，这两种方法都有额外影响，如非必须直接使用 node 的 <a href="https://nodejs.org/en/docs/guides/getting-started-guide/">require</a> 方法。</p>

<h3 id="方法1-用-bazel-引导">方法1: 用 bazel 引导</h3>

<p>安装 babel 包：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">npm</span> <span class="nx">install</span> <span class="nx">babel</span><span class="o">-</span><span class="nx">register</span> <span class="nx">babel</span><span class="o">-</span><span class="nx">preset</span><span class="o">-</span><span class="nx">env</span> <span class="o">--</span><span class="nx">D</span>
</code></pre></div></div>

<p>然后编写一个新的 js 文件作为程序的执行入口，用下面的方法加载要运行的模块：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">babel-register</span><span class="dl">'</span><span class="p">)</span> <span class="p">({</span>
    <span class="na">presets</span><span class="p">:</span> <span class="p">[</span> <span class="dl">'</span><span class="s1">env</span><span class="dl">'</span> <span class="p">]</span>
<span class="p">})</span>

<span class="nx">module</span><span class="p">.</span><span class="nx">exports</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">./app.js</span><span class="dl">'</span><span class="p">)</span>
</code></pre></div></div>

<p>文件结构如下：</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>├── app.js
├── install.sh
├── module1.js
├── run.sh
└── start.js
</code></pre></div></div>

<p>运行：</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>node ./start.js
</code></pre></div></div>

<h3 id="方法2-experimental-modules">方法2: –experimental-modules</h3>

<p>截止 Node 12，–experimental-modules 是 node 的试验特性，需要在 node 运行的时候指定，并且 js 文件的后缀要修改成 .mjs：</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">.</span>
├── app.mjs
├── module1.mjs
└── run.sh
</code></pre></div></div>

<p>引用时也要使用 .mjs 后缀：</p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">module1</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">./module1.mjs</span><span class="dl">'</span>
</code></pre></div></div>

<p>运行时，指定参数：</p>

<div class="language-sh highlighter-rouge"><div class="highlight"><pre class="highlight"><code>node <span class="nt">--experimental-modules</span> ./app.mjs
</code></pre></div></div>

<h2 id="参考">参考</h2>

<ol>
  <li><a href="https://www.lijiaocn.com" title="李佶澳的博客">李佶澳的博客</a></li>
  <li><a href="https://es6.ruanyifeng.com/#docs/module" title="ECMAScript 6 入门：Module 的语法">ECMAScript 6 入门：Module 的语法</a></li>
</ol>


</div>

<div class="copyright">
    <!--div style="text-align:center;">
    
    <img style="max-width: 250px" src="/blog/img/money.jpg"/>
    <p><a style="text-align:center;color:red" href="/blog/img/money.jpg">微信公众号</a></p>
    
</div-->


<div style="text-align:center">
    <p style="color:gray"><span>作者:李佶澳</span>&nbsp;&nbsp;<span>更新时间:2019-06-22T19:01:33+0800</span></p>

</div>


<!-- 底部二维码并列 -->
<!--ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8176866190626448"
     data-ad-slot="1398175214"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script-->

</div>

<div style="text-align:center">
  <p>

<span class="glyphicon glyphicon-folder-open" style="color:lightgray"></span>


<span>&nbsp<a href="/blog/c/tutorial/">系列教程</a>&nbsp</span>



<span class="glyphicon glyphicon-tag" style="color:lightgray"></span>
<span><a href="/blog/t/all/#项目">项目</a>&nbsp</span>

</p>

</div>

<div>
  
<div class="prevnext">
    <div style="text-align:left">
        
        <span>上一篇：</span><span><a href="/blog/tutorial/2019/06/22/javascript-04-node-usage/">JavaScript/ES6 快速上手教程（四）：Node.js用法</a></span>
        
    </div>

    <div style="text-align:right">
      
      <span>下一篇：</span><span><a href="/blog/tutorial/2019/06/19/javascript-02-env/">JavaScript/ES6 快速上手教程（二）：运行环境</a></span>
       
    </div>
</div>


</div>

            </article>


            
            <aside class="rsidebar">
                <div class="rsidebar-content">
  <div class="searchbar ">
    <form action="https://www.google.com/search" class="searchform" method="get" name="searchform" target="_blank">
    <div class="row">
      <div class="">
        <input name="sitesearch" type="hidden" value="lijiaocn.com">
        <input autocomplete="on" class="form-controls search" name="q" placeholder="站内搜索" required="required"  type="text">
        <button class="button" type="submit">Google</button>
      </div>
    </div>
    </form>
  </div>

  <!--div class="">
    <h4 style="color:brown">专属公众号（微信扫一扫）</h4>
    <img src="/blog/img/self.jpg"></img>
  </div-->

  <div class="">
    <a href="https://www.lijiaocn.com/shop"><h3>每日红包</h3></a>
    <a target="_blank" style="" href="https://www.amazon.cn?tag=znrio-23">亚马逊图书</a>&nbsp;
    <a target="_blank" style="" href="https://c.duomai.com/track.php?k=WYppWas1DZpVXZmcDOwMTPklWYmAjMzUjMy0DZp9VZ0l2cmYiRyUSbvNmLzYTMuU3b5ZkMlYkMlE0MlAHd0hWP0Zibj9">网易严选</a>&nbsp;
    <a target="_blank" style="" href="https://c.duomai.com/track.php?site_id=224482&lid=4193&aid=61&euid=lijiaocn&t=http%3A%2F%2Fwww.360buy.com%2F">京东</a>&nbsp;
    <br>
    <a target="_blank" style="" href="https://c.duomai.com/track.php?k=lAHd0hWP0Zibj9WYppWas1DZpVXZmQDOzMTPklWYmAjMzUjMy0DZp9VZ0l2cmYiJpFWbvVHZfB3ckR0Ml02byZmeGNTJGJTJt92Yu8Wd69WY6ZkMlYkMlE0M">造作</a>&nbsp;
    <a target="_blank" style="" href="https://c.duomai.com/track.php?k=m0DZpVXZmITO5MTPklWYmAjMzUjMy0DZp9VZ0l2cm02bj5CdyF2d55yd3dnRyUiRyUSQzUycwRHdo1Dd" >艺网</a>&nbsp;
    <a target="_blank" style="" href="https://c.duomai.com/track.php?k=ibj9WYppWas1DZpVXZmMDMxITPklWYmAjMzUjMy0DZp9VZ0l2cmYiJuNmLt92YukHbu9WZz9mcuc3d3ZkMlYkMlE0MlAHd0hWP0Z">roseonly</a>
    <br>
    <a target="_blank" style="" href="https://c.duomai.com/track.php?k=o1DdmYXYu1DZpVXZmIDO5cTPklWYmITMyUzM30DZp9VZ0l2cmYiJGJTJuNmLt92YuMXYklGZh5yd3dnRyUiRyUSQzUycwRHd&dm_fid=16055">阿迪达斯</a>&nbsp;
    <a target="_blank" style="" href="https://c.duomai.com/track.php?k=Hd0hWP0Zidh5WPklWdlZyN4MTPklWYmUTMyUzM30DZp9VZ0l2cmwWb0hmL4VGZulmRyUSbvNmLsxWYtZnL3d3dGJTJGJTJBNTJzB&dm_fid=16055">华为</a>&nbsp;
    <a target="_blank" style="" href="https://c.duomai.com/track.php?k=0RHa9QnJyFmYlRWaz1DZpVXZmATNwkTPklWYmMDMyUzM30DZp9VZ0l2cmYkMlA3boNnRyUibjZkMl02bj5icv52bolGauc3d3ZkMlYkMlE0MlMHc&dm_fid=16055">荣耀</a>&nbsp;
    <br>
    <a target="_blank" style="" href="https://c.duomai.com/track.php?k=j9WYppWas1DZpVXZmczM3ETPklWYmAjMzUjMy0DZp9VZ0l2cmYiJGJTJt92YuEGbvF2auc3d3ZkMlYkMlE0MlAHd0hWP0Zib">考拉海购</a>&nbsp;
    <a target="_blank" style="" href="https://c.duomai.com/track.php?k=Ha9QnJ2Fmb9QWa1VmJ0YTPklWYmYDMyUzM30DZp9VZ0l2cmYiJGJTJt92YucmbhR2ZuFGZuc3d3ZkMlYkMlE0MlMHc0R&dm_fid=16055">当当</a>&nbsp;
    <br>
    <a target="_blank" style="" href="https://c.duomai.com/track.php?k=ukWepFXauAXa2ZkMlYkMlE0MlMHc0RHa9QnJ2Fmb9QWa1VmJ5UDN0ETPklWYmkDMyUzM30DZp9VZ0l2cmwWb0hmL4VGZulmRyUyclxWYzRnbp9maGJTJu9WauVnRyUSe0lmdpR3YhZkMlAVSWVDbtRHaGJTJt92Y&dm_fid=16055">爱奇艺联名会员（手机打开）</a>&nbsp;
    <br>
    <a target="_blank" style="" href="https://c.duomai.com/track.php?k=WaqlGb9QWa1VmJ0ITMwETPklWYmEDM5kzM30DZp9VZ0l2cm02bj5ibhVHdpVWbukmRyUiRyUSQzUycwRHdo1Ddm42YvF&dm_fid=16055">美团外卖红包（手机打开）</a>&nbsp;
    <br>
    <a target="_blank" style="" href="https://c.duomai.com/track.php?k=2Fmb9QWa1VmJ3ITMwETPklWYmADMyUzM30DZp9VZ0l2cmYiJt92Yu4WY1RXal1mLpZkMlYkMlE0MlMHc0RHa9QnJ&dm_fid=16052">美团闪购红包（手机打开）</a>&nbsp;
  </div>

  <div class="">
    <img src="/blog/img/money.jpg"></img>
  </div>
  <!--div class="">
    <h4 style="color:brown">淘宝天猫优惠券（微信扫一扫）</h4>
    <img src="https://www.lijiaocn.com/img/tuanhaohuo.jpg"></img>
  </div-->

  <div class="">
    <h5 style="color:gray">赞助商广告</h5>
  <!-- 右侧边栏广告 -->
  <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8176866190626448"
     data-ad-slot="2723439605"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  </div>

  <div class="">
  <!-- 右侧边栏广告2 -->
  <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8176866190626448"
     data-ad-slot="4426808013"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  </div>

  <div class="">
  <!-- 右侧边栏广告3 -->
  <ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8176866190626448"
     data-ad-slot="3551466770"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
  <script>
  (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
  </div>
</div>

            </aside>
            
        </div>
        <div class="main-footer">
            <div class="page_bottom_ad">
                <!-- 底部横幅广告 -->
<ins class="adsbygoogle"
     style="display:block"
     data-ad-client="ca-pub-8176866190626448"
     data-ad-slot="4061827929"
     data-ad-format="auto"
     data-full-width-responsive="true"></ins>
<script>
     (adsbygoogle = window.adsbygoogle || []).push({});
</script>

            </div>

            <div class="related">
                <!-- Google 匹配内容页面-->
<ins class="adsbygoogle"
   style="display:block"
   data-ad-format="autorelaxed"
   data-ad-client="ca-pub-8176866190626448"
   data-ad-slot="6443696990"></ins>
<script>
   (adsbygoogle = window.adsbygoogle || []).push({});
</script>

            </div>
        </div>
    </section>

    <footer class="foot">
    <p>
<span></span>
<span>Copyright @2011-2019 All rights reserved.</span>
</p>

<p>
<span>友情链接:</span>&nbsp;
<span><a style="color:white"  href="/note/">小鸟笔记</a></span>&nbsp;
<span><a style="color:white"  href="/soft/">软件手册</a></span>&nbsp;
<span><a style="color:white"  href="/prog/">编程手册</a></span>&nbsp;
<span><a style="color:white"  href="/oper/">运营手册</a></span>&nbsp;
<span><a style="color:white"  href="/movie/">爱马影视</a></span>&nbsp;
<span><a style="color:white"  href="/class/">网络课程</a></span>&nbsp;
<span><a style="color:white"  href="/skill/">奇技淫巧</a></span>&nbsp;
<span><a style="color:white"  href="/tutorial/">课程文档</a></span>&nbsp;
<span><a style="color:white"  href="/wechat/news/">精选文章</a></span>&nbsp;
<span><a style="color:white"  href="https://www.baidu.com/">百度搜索</a></span>
<span><a style="color:white"  href="https://www.google.com/">谷歌搜索</a></span>
</p>

    </footer>

    <script src="/blog/assets/js/jquery-1.24.4.min.js"></script>
    <script src="/blog/assets/bootstrap-3.3.7/js/bootstrap.min.js"></script>
    <script src="/blog/assets/js/body.js"></script>
</body>
</html>
